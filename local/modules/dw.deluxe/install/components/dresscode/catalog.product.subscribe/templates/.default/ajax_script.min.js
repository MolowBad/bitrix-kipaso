$(function(){function i(e){return errorFlag=!1,void 0!==e&&(e.removeClass("error"),"yes"==e.data("required"))&&("text"==e.attr("type")?"yes"==e.data("email")?r(e.val())||(e.addClass("error"),errorFlag=!0):""==e.val()&&(e.addClass("error"),errorFlag=!0):"checkbox"!=e.attr("type")||e.prop("checked")||(e.addClass("error"),errorFlag=!0)),errorFlag}function t(s){var e=$("#bind__catalog-subscribe-submit").removeClass("error"),r=$('.subscribe[data-id="'+s.ITEM_ID+'"]');r.find("img"),void 0!==s&&("Y"==s.SUCCESS?($(".catalog-subscribe-container").addClass("hidden"),$(".catalog-subscribe-success").addClass("open"),r.each(function(e,r){var r=$(r),a=r.find("img");r.text(LANG.REMOVE_SUBSCRIBE_LABEL).prepend(a.attr({src:TEMPLATE_PATH+"/images/subscribeDelete.png"})).addClass("unSubscribe").data("subscribe-id",s.SUBSCRIBE_ID)})):($(".catalog-subscribe-container").addClass("hidden"),$(".catalog-subscribe-error").addClass("open"),e.addClass("error"),console.error(s))),e.removeClass(".loading")}function e(e){var r=$(this);return $(document).off("change","#bind__catalog-subscribe-form input"),$(document).off("click","#bind__catalog-subscribe-submit"),$(document).off("submit","#bind__catalog-subscribe-form"),$(".catalog-subscribe").remove(),$(".subscribeStyles").remove(),"yes"==r.data("reload")&&window.location.reload(),e.preventDefault()}var r=function(e){return/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(e)};$(document).on("change","#bind__catalog-subscribe-form input",function(e){var r=$(this).removeClass("error");i(r)}),$(document).on("click","#bind__catalog-subscribe-submit",function(e){return $("#bind__catalog-subscribe-form").trigger("submit"),e.preventDefault()}),$(document).on("submit","#bind__catalog-subscribe-form",function(e){var a,r=$(this),s=r.find("input"),o=r.find("#bind__catalog-subscribe-submit"),c=!1;return 0<s.length&&(s.each(function(e,r){r=$(r);(fieldError=i(r))&&(c=!0)}),c||("undefined"!=typeof subscribeAjaxDir&&""!=subscribeAjaxDir?"undefined"!=typeof SITE_ID&&""!=SITE_ID?(s=r.serializeArray(),a={},$.each(s,function(e,r){a[r.name]=r.value}),r={act:"sendSubscribeForm",site_id:SITE_ID},$.extend(r,a),$.ajax({url:subscribeAjaxDir+"/ajax.php",type:"POST",data:r,dataType:"json",success:t}),o.addClass("loading")):console.error("check vars - SITE_ID"):console.error("check vars - ajaxDir"))),e.preventDefault()}),$(document).on("click",".catalog-subscribe-container__exit",e),$(document).on("click",".subscribe-success-close__button",e),$(document).on("click",".subscribe-error-close__button",e)});