README для import_offers_from_files.php
Описание
Этот PHP-скрипт предназначен для импорта и синхронизации данных каталога товаров в CMS 1C-Bitrix. 
Он парсит информацию о товарах из XML-файла (catalogOven.xml) и переопределяет конкретные детали (например, краткие описания и цены) из XLSX-файла (korotkoeopicanietovarov.xlsx). Скрипт создаёт или обновляет товары и торговые предложения (ТП) в инфоблоках Bitrix, отдавая приоритет данным из XLSX для названий торговых предложений (используя столбец "Краткие характеристики", если он доступен). Также устанавливаются приоритеты сортировки: ТП из XLSX получают SORT=100 (высший приоритет), из XML — SORT=200.
Скрипт обеспечивает отсутствие дубликатов, очищает кэш после выполнения и логирует все операции.
Требования

PHP 8.2 или выше (версия для CLI).
Установленная CMS 1C-Bitrix с доступом к инфоблокам (ID 16 для товаров, 17 для предложений).
Файлы: catalogOven.xml и korotkoeopicanietovarov.xlsx в директории /local/scripts/torgovie_predlozenia/.
Увеличенный лимит памяти (рекомендуется 1 ГБ для больших XLSX-файлов).

Как запустить

Перейдите в директорию скрипта в терминале:
textcd /home/i/itkipae3/test2.owen.kipaso.ru/public_html/local/scripts/torgovie_predlozenia

Запустите скрипт с использованием PHP 8.2 (с увеличенной памятью при необходимости):
text/usr/local/bin/php8.2 import_offers_from_files.php

Для большего объёма памяти/времени: /usr/local/bin/php8.2 -d memory_limit=1G -d max_execution_time=0 import_offers_from_files.php


Скрипт запускается только в режиме CLI (терминал). Он будет логировать прогресс в файл import_log.txt в той же директории.

Примечания

Время выполнения: Может занять часы для больших файлов (например, более 70 тыс. строк в XLSX).
Ошибки: Проверяйте import_log.txt для деталей (например, отсутствие обязательных полей в Bitrix).
Настройка: Корректируйте ID инфоблоков или пути при необходимости. Установите $DRY_RUN = true; для тестового режима (без изменений в БД).