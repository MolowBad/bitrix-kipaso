BX.namespace("BX.Sale.Dellin.YuriSettings"),BX.Sale.Dellin.YuriSettings={ajaxUrl:"",serviceLocationClass:"",getLogin:function(){return document.querySelector('[name="CONFIG[MAIN][LOGIN]"]')},getPass:function(){return document.querySelector('[name="CONFIG[MAIN][PASSWORD]"]')},getCounterAgents:function(){let e=document.querySelector('[name="CONFIG[YURI][COUNTERAGENT]"]'),t=BX.Sale.Dellin.DerivalSettings.getAppkey().value,n=this.getLogin().value,i=this.getPass().value,l={sessid:BX.bitrix_sessid(),appkey:t,login:n,password:i,action:"get_counteragents",class:BX.Sale.Dellin.DerivalSettings.serviceAjaxClass};BX.ajax({timeout:300,method:"POST",dataType:"json",url:BX.Sale.Dellin.YuriSettings.ajaxUrl,data:l,onsuccess:function(t){t&&t.counteragents.map((function(t){BX.Sale.Dellin.YuriSettings.builderOptionList(e,t.uid,t.name,"counteragent")}))},onfailure:function(e){}})},builderOptionList:function(e,t,n,i){let l=document.createElement("option");l.innerHTML=n,l.value=t,l.id=i+"-added",l.selected=e.dataset.value==t,e.appendChild(l)},getOpfData:function(){let e=BX.Sale.Dellin.DerivalSettings.getAppkey().value;if(!e)return;let t={sessid:BX.bitrix_sessid(),appkey:e,action:"get_opf",class:BX.Sale.Dellin.DerivalSettings.serviceAjaxClass},n=document.querySelector('[name="CONFIG[YURI][OPF_COUNTRY]"]'),i=document.querySelector('[name="CONFIG[YURI][OPF]"]');BX.ajax({timeout:300,method:"POST",dataType:"json",url:BX.Sale.Dellin.YuriSettings.ajaxUrl,data:t,onsuccess:function(e){e&&(Object.values(e.countries).forEach((function(e){let t=e.countryUID,i=e.country;BX.Sale.Dellin.YuriSettings.builderOptionList(n,t,i,"country")})),n.addEventListener("change",(function(){BX.Sale.Dellin.YuriSettings.clearOpfList(),BX.Sale.Dellin.YuriSettings.getOpfList(n,i,e),i.dataset.value=!1})),i.dataset.value&&BX.Sale.Dellin.YuriSettings.getOpfList(n,i,e))},onfailure:function(e){}})},getOpfList:function(e,t,n){for(let i=0;i<Object.keys(n.opf).length;i++)if(Object.keys(n.opf)[i]==e.value){let e=Object.values(n.opf)[i];Object.entries(e).map((function(e){let n=e[0],i=e[1];BX.Sale.Dellin.YuriSettings.builderOptionList(t,n,i,"opf")}))}},clearOpfList:function(){let e=document.querySelectorAll("#opf-added");e&&e.forEach((function(e){e.parentNode.removeChild(e)}))}};