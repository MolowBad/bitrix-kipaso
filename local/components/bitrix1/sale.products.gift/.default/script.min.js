window.JCSaleProductsGiftComponent||(window.JCSaleProductsGiftComponent=function(t){this.formPosting=!1,this.siteId=t.siteId||"",this.template=t.template||"",this.componentPath=t.componentPath||"",this.parameters=t.parameters||"",this.container=document.querySelector('[data-entity="'+t.container+'"]'),this.currentProductId=t.currentProductId,t.initiallyShowHeader&&BX.ready(BX.delegate(this.showHeader,this)),t.deferredLoad&&BX.ready(BX.delegate(this.deferredLoad,this)),BX.addCustomEvent("onCatalogStoreProductChange",BX.delegate(function(t){t=parseInt(t),this.currentProductId!==t&&(this.currentProductId=t,this.offerChangedEvent())},this))},window.JCSaleProductsGiftComponent.prototype={offerChangedEvent:function(){this.sendRequest({action:"deferredLoad",offerId:this.currentProductId})},deferredLoad:function(){this.sendRequest({action:"deferredLoad"})},sendRequest:function(e){var t={siteId:this.siteId,template:this.template,parameters:this.parameters};BX.ajax({url:this.componentPath+"/ajax.php"+(-1!==document.location.href.indexOf("clear_cache=Y")?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(t,e),onsuccess:BX.delegate(function(t){t&&t.JS?BX.ajax.processScripts(BX.processHTML(t.JS).SCRIPT,!1,BX.delegate(function(){this.showAction(t,e)},this)):(this.hideHeader(),BX.cleanNode(this.container))},this)})},showAction:function(t,e){e&&"deferredLoad"===e.action&&this.processDeferredLoadAction(t)},processDeferredLoadAction:function(t){t&&this.processItems(t.items)},processItems:function(t){if(t){var a,e,t=BX.processHTML(t,!1),i=BX.create("DIV");for(e in i.innerHTML=t.HTML,this.container.querySelectorAll('[data-entity="items-row"]').length?(BX.cleanNode(this.container),this.showHeader(!1)):this.showHeader(!0),a=i.querySelectorAll('[data-entity="items-row"]'))a.hasOwnProperty(e)&&(a[e].style.opacity=0,this.container.appendChild(a[e]));new BX.easing({duration:1e3,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){for(var e in a)a.hasOwnProperty(e)&&(a[e].style.opacity=t.opacity/100)},complete:function(){for(var t in a)a.hasOwnProperty(t)&&a[t].removeAttribute("style")}}).animate(),BX.ajax.processScripts(t.SCRIPT)}},showHeader:function(t){var e,a=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}});a&&BX.type.isDomNode(a)&&(e=a.querySelector('[data-entity="header"'))&&"false"===e.getAttribute("data-showed")&&(e.style.display="",t?(this.animation=new BX.easing({duration:2e3,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){e.style.opacity=t.opacity/100},complete:function(){e.removeAttribute("style"),e.setAttribute("data-showed","true")}}),this.animation.animate()):e.style.opacity=100)},hideHeader:function(){var t=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}});t&&BX.type.isDomNode(t)&&(t=t.querySelector('[data-entity="header"'))&&(this.animation&&this.animation.stop(),t.style.display="none",t.style.opacity=0,t.setAttribute("data-showed","false"))}});